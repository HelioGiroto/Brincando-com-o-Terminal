javascript:(async () =>{ function download(conteudo){ const nomearq = "contatos-nao-salvos.csv"; const mimeType = "text/csv;charset=utf-8;"; const a = document.createElement('a'); const blob = new Blob([conteudo], {type: mimeType}); const url = URL.createObjectURL(blob); a.setAttribute('href', url);	a.setAttribute('download', nomearq); a.click(); }; let anterior = -1; let atual = 0; let contatos = []; let padrao = /^\+/; const seletorCaptura = 'div[role="gridcell"] > div > div > span'; const d = new Date(); let dia = d.getDay(); if (dia < 10) dia = `0${dia}`; let mes = d.getMonth()+1; if (mes < 10) mes = `0${mes}`; let ano = d.getFullYear(); let dataAtual = `${ano}${mes}${dia}`; let hora = d.getHours(); let minuto = d.getMinutes(); if (minuto < 10) minuto = `0${minuto}`; let horaAtual = `${hora}:${minuto}`; while(atual > anterior){ await new Promise(resolve => setTimeout(resolve, 2500)); anterior = atual; let lista = document.querySelectorAll(seletorCaptura); lista.forEach(a=> {if(padrao.test(a.innerText)){ contatos.push(a.innerText);}}); document.querySelector('#pane-side').scrollTop += 300; atual = document.querySelector('#pane-side').scrollTop;}; let filtrados = [...new Set(contatos)].sort(); await new Promise(resolve => setTimeout(resolve, 2500)); let novosContatos = []; filtrados.map((e,i)=>{ e = `CTT ${dataAtual} n ${i} - ${horaAtual},${e}`; novosContatos.push(e);}); novosContatos.unshift("Name,Mobile Phone"); let resultado = [...novosContatos].join('\n'); download(resultado); alert(`Terminado! Foram ${filtrados.length} novos contatos baixados.\nAgora suba o arquivo baixado para o Google Contacts.`); window.open("https://contacts.google.com",  "_blank");})();
